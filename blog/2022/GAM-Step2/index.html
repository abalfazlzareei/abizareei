<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta http-equiv="X-UA-Compatible" content="IE=edge">

<title>Abalfazl  Zareei | Generalized Additive Models (GAMs) Part 2</title>
<meta name="description" content="Personal homepage of Abalfazl Zareei.
">

<!-- Open Graph -->


<!-- Bootstrap & MDB -->
<link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet" integrity="sha512-MoRNloxbStBcD8z3M/2BmnT+rg4IsMxPkXaGh2zD6LGNNFE80W3onsAhRcMAMrSoyWL9xD7Ert0men7vR8LUZg==" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.19.1/css/mdb.min.css" integrity="sha512-RO38pBRxYH3SoOprtPTD86JFOclM51/XTIdEPh5j8sj4tp8jmQIx26twG52UaLi//hQldfrh7e51WzP9wuP32Q==" crossorigin="anonymous" />

<!-- Fonts & Icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css"  integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.9.0/css/academicons.min.css" integrity="sha512-W4yqoT1+8NLkinBLBZko+dFB2ZbHsYLDdr50VElllRcNt2Q4/GSs6u71UHKxB7S6JEMCp5Ve4xjh3eGQl/HRvg==" crossorigin="anonymous">
<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons">

<!-- Code Syntax Highlighting -->
<link rel="stylesheet" href="https://gitcdn.link/repo/jwarby/jekyll-pygments-themes/master/github.css" />

<!-- Styles -->
<link rel="shortcut icon" href="/abizareei/assets/img/favicon.ico">
<link rel="stylesheet" href="/abizareei/assets/css/main.css">

<link rel="canonical" href="/abizareei/blog/2022/GAM-Step2/">

<!-- Theming-->



  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-PLGZ9F55MY"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());

    gtag('config', 'G-PLGZ9F55MY');
  </script>


    
<!-- MathJax -->
<script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.1.2/es5/tex-mml-chtml.js"></script>
<script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>


  </head>

  <body class="fixed-top-nav ">

    <!-- Header -->

    <header>

    <!-- Nav Bar -->
    <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top">
    <div class="container">
      
      <a class="navbar-brand title font-weight-lighter" href="https://abalfazlzareei.github.io/abizareei/">
       <span class="font-weight-bold">Abalfazl</span>   Zareei
      </a>
      
      <!-- Navbar Toogle -->
      <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar top-bar"></span>
        <span class="icon-bar middle-bar"></span>
        <span class="icon-bar bottom-bar"></span>
      </button>
      <div class="collapse navbar-collapse text-right" id="navbarNav">
        <ul class="navbar-nav ml-auto flex-nowrap">
          <!-- About -->
          <li class="nav-item ">
            <a class="nav-link" href="/abizareei/">
              about
              
            </a>
          </li>
          <!-- Other pages  | sort: "title" -->
          
          
          
          <li class="nav-item ">
              <a class="nav-link" href="/abizareei/publications/">
                publications
                
              </a>
          </li>
          
          
          
          <li class="nav-item ">
              <a class="nav-link" href="/abizareei/projects/">
                research
                
              </a>
          </li>
          
          
          
          <li class="nav-item ">
              <a class="nav-link" href="/abizareei/teaching/">
                teaching
                
              </a>
          </li>
          
          
          
          
          
          
          
          
          
          
          
          
          <!-- Blog -->
          <li class="nav-item active">
            <a class="nav-link" href="/abizareei/blog/">
              blog
              
            </a>
          </li>
                      
        </ul>
      </div>
    </div>
  </nav>

</header>


    <!-- Content -->

    <div class="container mt-5">
      

<div class="post">

  <header class="post-header">
    <h1 class="post-title">Generalized Additive Models (GAMs) Part 2</h1>
    <p class="post-meta">January 22, 2022</p>
  </header>

  <article class="post-content">
    <p>Consider a GAMs model as follows:</p>

\[Y=\alpha + \sum_{j=1}^{P}f_{j}(X_{j}) + \epsilon\]

<p>We can estimate the functions, \(f_{j}\), by minimizing the penalized residual sum of squares as follows:</p>

\[RSS=\sum_{i=1}^{N}(y_{i}-\alpha-\sum_{j=1}^{p}f_{j}(x_{ij}))^2+\sum_{j=1}^{p}\lambda_{j}\int f_{j}^{''}(t_{j})^2dt_{j}\]

<p>The first term in the above equation measures how close our functions are to the data, and the second term penalizes curvature in the estimated functions. The \(\lambda_{j}\), the smoothing parameter, decides on the tradeoff for each function \(j\). If \(\lambda\) is infinitive, then we are only looking for a simple linear fit; because no curvature (second-order derivative) is tolerated!</p>

<p>Naturally, the cubic splines can be estimated for the functions, \(f_{j}\). How do we estimate them? Let’s see.</p>

<p><strong>The constant \(\alpha\):</strong> This constant is shared across all the functions, \(f_{j}\) and does not add value to the functions estimations. We can go on and set \(\alpha = \sum_{i=1}^{N}y_{i}\). In this way, the functions, \(f_{j}\) , also average zero, \(\sum_{i=1}^{N}f_{j}(x_{ij})=0\).</p>

<p><strong>Iterative procedure:</strong> Given the above, we can run an iterative procedure to estimate the functions, \(f_{j}\), as follows:</p>

<p><strong><em>Algorithm for estimating Additive Models</em></strong></p>

<p>(Friedman, Hastie, Tibshirani, 2009)</p>

\[1. \text{      Set   } \alpha= \sum_{i=1}^{N}y_{i}, \hat{f}_{j}=0\]

\[2. \text{      For     } j=1,2,3,...,p, 1,2,3,...,p,1,2,...,\]

\[\hat{f}_{j}\leftarrow Spline[(y_{i}-\hat{\alpha}-\sum_{k\ne j}\hat{f}_{k}(x_{ij}))_{1}^{N}]\]

\[\hat{f}_{j}\leftarrow \hat{f}_{j}-\frac{1}{N}\sum_{i=1}^{N}\hat{f}_{j}(x_{ij})\]

<p>We repeat the above until the functions stabilize (or change less than a prespecified threshold). I should note that, in the above algorithm, we can use other fitting methods instead of splines, different functions for different variables, and functions that include interactions between variables. The overall point is this: <strong><em>we can control the non-linearity in a way that we can interpret it</em></strong>. Isn’t that wonderful?</p>

<p>Next, I will run the GAMs model in python on a simple example, and soon, I will check its performance on predicting assets’ excess return. But before, let me give you an overview of the evolution from linear models to GAMs.</p>

<p>Let’s say we have a dependent variable \(y\) and two independent variables, \(X_{1}\) and \(X_{2}\). In the simplest form, we have the standard linear model in which independent variable related to the mean dependent variable linearly as follows:</p>

<ul>
  <li><strong>Linear model</strong></li>
</ul>

\[y\sim\mathcal{N}(\mu,\sigma^{2})\\
\mu = \beta_{0} + \beta_{1}X_{1} + \beta_{2}X_{2}\]

<p>Next, to add non-linearity to our linear models, we can use polynomial models. We can use the same procedure as the linear model to estimate the coefficients. As an example, we have:</p>

<ul>
  <li><strong>Polynomial</strong></li>
</ul>

\[y\sim\mathcal{N}(\mu,\sigma^{2})\\
\mu = \beta_{0} + \beta_{1}X_{1} + \beta_{2}X_{2}^{2}\]

<p>Next, we have the Generalized Linear Model (GLM), in which we use a link function (\(g\)) to relate the predictors to the response variable. It is modeled as follows:</p>

<ul>
  <li><strong>GLM</strong></li>
</ul>

\[y\sim\mathcal{N}(\mu,\sigma^{2})\\
\mu = g^{-1}(\beta_{0} + \beta_{1}X_{1} + \beta_{2}X_{2}^{2})\]

<p>And finally, we have the Generalized Additive Models (GAMs) in which the predictors are related to the response variables with a link function \(g\). In addition, the independent variables are free to choose how they relate to the response variable with functions, \(f_{j}\).</p>

<ul>
  <li><strong>GAMs</strong></li>
</ul>

\[y\sim\mathcal{N}(\mu,\sigma^{2})\\
\mu = g^{-1}(\alpha_{0} + f_{1}(X_{1}) + f_{2}(X_{2}))\]

<p>Next, let us go through a simple example in python and see how GAMs does its job.</p>

  </article>

  

</div>

    </div>

    <!-- Footer -->

   
<footer class="fixed-bottom">
  <div class="container mt-0" style="text-align:center;">
    &copy; Copyright 2022 Abalfazl  Zareei.
    <!--  -->     
    
    Last updated: September 25, 2022.
    
  </div>
</footer>

 

  </body>

  <!-- jQuery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>

  <!-- Bootsrap & MDB scripts -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/2.4.4/umd/popper.min.js" integrity="sha512-eUQ9hGdLjBjY3F41CScH3UX+4JDSI9zXeroz7hJ+RteoCaY+GP/LDoM8AO+Pt+DRFw3nXqsjh9Zsts8hnYv8/A==" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js" integrity="sha512-M5KW3ztuIICmVIhjSqXe01oV2bpe248gOxqmlcYrEzAvws7Pw3z6BK0iGbrwvdrUQUhi3eXgtxp5I8PDo9YfjQ==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.19.1/js/mdb.min.js" integrity="sha512-Mug9KHKmroQFMLm93zGrjhibM2z2Obg9l6qFG2qKjXEXkMp/VDkI4uju9m4QKPjWSwQ6O2qzZEnJDEeCw0Blcw==" crossorigin="anonymous"></script>

  
<!-- Mansory & imagesLoaded -->
<script defer src="https://unpkg.com/masonry-layout@4/dist/masonry.pkgd.min.js"></script>
<script defer src="https://unpkg.com/imagesloaded@4/imagesloaded.pkgd.min.js"></script>
<script defer src="/abizareei/assets/js/mansory.js" type="text/javascript"></script>


  


<!-- Load Common JS -->
<script src="/abizareei/assets/js/common.js"></script>

<!-- Load DarkMode JS -->
<script src="/abizareei/assets/js/dark_mode.js"></script>


</html>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-77789841-2', 'auto');
  ga('send', 'pageview');

</script>

